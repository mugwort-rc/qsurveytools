# アンケート設定

## 設問設定 { #base_setting }

![setting.png](img/setting.png)

### ID { #id }

**ID**行には[アンケートソース]の列と同じ設問IDを設定してください。（例：`Q1`など）

**注意**：
重複するIDは使用することができません。

以下のIDは使用することができません。

* `ID`
* `=`を含むID

### 設問名 { #title }

**設問名**行には設問タイトルを設定してください。（例：`問1 あなたの性別をお答えください。`など）

### 設問種別 { #type }

**設問種別**行には回答種別を設定します。

* `S` : 単数回答
* `M` : 複数回答
* `F` : 自由回答

以上のいずれかの値が認識されます。

誤って複数指定した場合、`F` > `S` > `M`の順に優先されますので注意してください。（例：`SF` -> `F`, `SM` -> `S`）

#### 複数回答制限 { #limit }

複数回答の個数を制限することができます。

指定しない場合は無制限と解釈されます。

条件の記述方法は以下の通りです。

* `M(3)`：3個を上限に設定します。
* `M(3)[5]`：[複数回答例外]との組み合わせ例で、3個を上限とし、5を例外とします。
* `M[5](3)`：上と同じように解釈されます。

制限を超える値が入力された場合、入力データ検証時に警告として記録されます。

例：

* `M(3)`の時に`1,2,5,6`と入力された場合。

#### 複数回答例外 { #multiex }

「その他」や「問題はない」といった、他の選択肢と重複できない選択肢を設定することができます。

指定しない場合は例外はないものとして解釈されます。

条件の記述方法は以下の通りです。

* `M[6]`：6のみ重複不可とします。
* `M[6, 7]`：6,7のいずれかを選んだ場合、重複不可とします。
* `M[5](3)`：[複数回答制限]との組み合わせ例で、5を例外とし、上限は3個となります。
* `M(3)[5]`：上と同じように解釈されます。

例外値と共に他の値が入力された場合、入力データ検証時に警告として記録されます。

例：

* `M[5]`の時に`2,5`と入力された場合。
* `M[5,6]`の時に`5,6`と入力された場合。

### 該当 { #ok }

**該当**行には回答を許可する条件を設定します。

条件の記述方法は以下の通りです。

* `Q1`で`1`を選択： `Q1=1`
* `Q1`で`1`または`2`を選択： `Q1=1,2`
* `Q1`で`1`かつ`Q2`で`1,2,3`を選択： `Q1=1 & Q2=1,2,3`

### 禁止 { #ng }

**禁止**行には回答を禁止する場合の条件を設定します。

条件の記述方法は**[該当]**行と同じです。

### 6行目以降 { #choices }

6行目以降は設問選択肢の入力欄となります。

選択肢に対応する値は`1`から始まります。

空白セルは無視されるため、選択肢と選択肢の間にダミーの選択肢を挿入したい場合、何らかの値を入力してください。

1. A
2. B
3. C
4. 
5. X

このように入力した場合、

1. A
2. B
3. C
4. X

このように認識します。


## クロス設定 { #cross_setting }

**クロス集計を使用しない場合は何も入力せず、そのままにしてください。**

![cross.png](img/cross.png)

C3以降の灰色のセルは認識しません。

### 表頭 { #target }

**表頭**にはクロス集計の表頭となるIDを指定します。

![cross_target.png](img/cross_target.png)

表頭の**要素名**に指定した名前はシート名になります。

### 表側 { #key }

**表側**にはクロス集計の表側となるIDを指定します。

![cross_key.png](img/cross_key.png)

表側の**要素名**は[シングルテーブル]・[畦道スタイル]の表側に表示されます。（詳しくはクロス集計設定の[テーブルスタイル]を参照して下さい。）


[アンケートソース]: source.html
[テーブルスタイル]: aggregation.html#table-style
[シングルテーブル]: aggregation.html#table-style-single-table
[畦道スタイル]: aggregation.html#table-style-azemichi
[複数回答制限]: #limit
[複数回答例外]: #multiex
[該当]: #ok
