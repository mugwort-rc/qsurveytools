# 集計

## メニュー

![mainwindow-menu.png](img/mainwindow-menu.png)

1. **入力**に[入力ファイル]を設定します。
2. **出力**に出力先のフォルダを設定します。

**Tips:**

* 右の`...`ボタンを押すと選択ダイアログが起動します。
* 入力エリアにファイルをドラッグ＆ドロップすると自動で入力されます。

--------------------------------------------------------------------------------

## メッセージ

![mainwindow-message.png](img/mainwindow-message.png)

メッセージタブは[警告]等が発生したときに自動的に切り替わります。

メッセージごとの詳細は[トラブルシューティング]を参照してください。

--------------------------------------------------------------------------------

## 設定

### 共通

![mainwindow-settings-general.png](img/mainwindow-settings-general.png)

#### 無回答を除く

**無回答を除く**にチェックを入れると、集計から無回答を除きます。

**単純集計**

全体は無回答を除いた数が出力されます。

**クロス集計**

表頭・表側の一方が無回答である回答を除いた数が出力されます。

--------------------------------------------------------------------------------

#### %を付ける

集計の割合に%を付けた形式で出力します。

--------------------------------------------------------------------------------

#### フィルターを波及させる

デフォルトで有効になっています。

**有効**の場合、条件の参照先の条件も波及して適用します。

**例：**Q2で`Q1=1,2`であるとき、Q3で`Q2=1`とした場合、Q3は`Q1=1,2 & Q2=1`と同じになります。

**無効**にすると、設問設定の条件付けを波及せず、個別の条件付けを厳密に適用します。

**例：**Q2で`Q1=1,2`であるとき、Q3で`Q2=1`としても、Q3は`Q2=1`のままになります。

**注：**この時、Q1で`3`を選んだ人がQ2で`1`を選んでいた場合、（Q2の`Q1=1,2`条件外であるのにもかかわらず）Q3の集計に含まれますので十分に注意して下さい。

--------------------------------------------------------------------------------

### 単純集計

![mainwindow-settings-simple.png](img/mainwindow-settings-simple.png)

#### 単数回答を円グラフにする

設問設定が単数回答（`S`）のグラフを円グラフにします。

複数回答（`M`）のグラフは横棒グラフで出力します。

--------------------------------------------------------------------------------

### クロス集計

![mainwindow-settings-cross.png](img/mainwindow-settings-cross.png)

#### テーブルスタイル { #table-style }

* [標準]( #table-style-general )
* [シングルテーブル]( #table-style-single-table )
* [畦道スタイル]( #table-style-azemichi )
* [畦道スタイル（拡張）]( #table-style-azemichi-advanced )

4種類の出力スタイルがあります。

##### 標準 { #table-style-general }

集計結果がそれぞれ独立したスタイルです。

![output-cross-general.png](img/output-cross-general.png)

--------------------------------------------------------------------------------

##### シングルテーブル { #table-style-single-table }

集計結果をひとつの表にまとめたスタイルです。

総数が同じ表を連結する場合、総数を省略します。

![output-cross-single-table.png](img/output-cross-single-table.png)

--------------------------------------------------------------------------------

##### 畦道スタイル { #table-style-azemichi }

集計と割合を交互に一つの表にまとめたスタイルです。

シングルテーブルと同様に、総数が同じ表を連結する場合、総数を省略します。

![output-cross-azemichi.png](img/output-cross-azemichi.png)

--------------------------------------------------------------------------------

##### 畦道スタイル（拡張） { #table-style-azemichi-advanced }

畦道スタイルの総数省略を行わないスタイルです。

毎回表頭が挿入されます。

![output-cross-azemichi-advanced.png](img/output-cross-azemichi-advanced.png)

--------------------------------------------------------------------------------

[入力ファイル]: input.html
[警告]: troubleshooting.html#warning
[トラブルシューティング]: troubleshooting.html
